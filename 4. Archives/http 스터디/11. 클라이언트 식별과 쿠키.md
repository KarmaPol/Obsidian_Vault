## 클라이언트 식별
### 개별 접촉
HTTP는 익명, 무상태 프로토콜이지만
웹서버는 사용자를 추적하기 위해 약간의 정보를 이용할 수 있다
#### 사이트 개인화
- 개별 인사
- 사용자 맞춤 추천
- 저장된 사용자 정보
- 세션 추적
### 사용자 식별 기술들
#### HTTP 헤더
- From 사용자 이메일 주소
  악의적으로 이메일 주소가 이용될 수 있음
- User-Agent 사용자 브라우저 정보
- Referer 사용자의 근원 페이지
  사용자 취향 등을 알아내기 용이함
#### 클라이언트 IP 주소
웹 서버는 HTTP 요청을 보낸 반대쪽 TCP 커넥션의 주소를 알 수 있다
하지만,
- IP는 컴퓨터 자체를 가리키므로 사용자 식별에 어려움이 있다
- IP는 동적으로 할당된다
- NAT 장비를 통해 IP주소를 숨긴다
- 프락시 서버의 주소를 가리킨다
-> 인트라넷 등에서는 유용한 방법
#### 사용자 로그인
로그인을 요구해서 명시적으로 식별 요청 가능
#### 뚱뚱한 URL
URL 마다 상태 정보를 추가해 확장 (쇼핑 카트, 프로필 등)
##### 문제점
- 못생긴 URL
- 상태정보를 포함하므로 공유하지 못하는 URL
- 캐시를 사용할 수 없음 -> 서버 부하 가중
- 이탈 시 초기화
- 세션 간 지속성 없음
## 쿠키
사용자 식별, 세션을 유지하는 방식 중 가장 널리 쓰이는 방식
- 쿠키는 캐시와 충돌할 수 있으므로 캐싱 하지 않는다
### 쿠키 타입
- 세션 쿠키
  사용자가 사이트 탐색 시 관련 설정과 선호 사항 저장하는 임시 쿠키
- 지속 쿠키
  디스크에 저장되어 사이트 정보나 로그인 이름 유지에 사용
### 쿠키 동작
서버의 사용자 추적 용으로는 단순 식별 정보만 포함
서버 응답 헤더 Set-Cookie : name = "Brian" 클라이언트 쿠키 지정
#### 사이트 마다 다른 쿠키들
브라우저가 갖는 수백 개의 쿠키를 사이트 마다 보내지 않는다 -> 두개, 세 개의 쿠키만을 보낸다
- 도메인 속성
  Set-cookie: user="mary"; domain = "airbnb.com"
  지정한 도메인으로 끝나는 사이트 방문 시 클라이언트는 쿠키 전송
- Path 속성
  URL 특정 Path만 지정 가능
### 쿠키와 세션 추적
1. 브라우저가 루트 페이지 요청
2. 서버는 전자 상거래 URL로 리다이렉트
3. 브라우저는 리다이렉트 URL로 요청
4. 서버는 두개의 세션 쿠키 기술하고 새로운 URL로 리다이렉트
5. 클라이언트는 새로운 URL에 쿠키와 함께 요청
6. 서버는 home.html 페이지로 리다이렉트하고 새로운 두개 쿠키 첨부
7. 클라이언트는 home.html 가져오고 총 4개의 쿠키 전달
8. 서버는 콘텐츠를 보낸다
### 쿠키와 캐싱
쿠키는 개인 정보가 있을수 있으므로 캐싱에 주의해야 한다
- 캐시되지 말아야 할 문서가 있으면 표시하라
- Set-Cookie 헤더를 캐시하면 사용자 추적이 어렵다
- Cookie 헤더가 포함된 요청에 응답으로 오는 문서를 캐시할때 주의하라
### 쿠키와 개인정보
쿠키는 그 자체로 보안 상 위험한 것은 아니다
- 개인 정보는 원격 DB에 저장하고 키 값을 쿠기에 저장하자