## 비관적 락
- 실제로 데이터에 Lock을 걸어 데이터 접근 방지, 데이터 정합성이 보장됨
  -> 성능에 영향이 있고, 데드락이 발생할 수 있다. 
  => 하지만, 동시성 문제가 빈번하다면 롤백 수가 줄어들어 오히려 성능이 우수할 수 있음
- 여러 테이블에 걸쳐 Lock을 걸면 데드락이 발생할 수 있음
## 낙관적 락
Lock을 이용하지 않고, 버전을 이용함으로써 정합성을 맞춤
먼저 데이터를 읽은 후, update를 수행할때 현재 내가 읽은 버전이 맞는지 확인
-> 버전에 수정사항이 있다면 다시 읽은 후 수행
## 네임드 락
이름을 가진 metadata lock
이름을 자닌 lock을 획득 후, 다른 세션은 이 lock 획득 불가능
별도의 명령어나 타임아웃으로 lock을 해제해야함
### Lock의 종류

**Shared Lock(공유, 읽기 잠금, s-lock)**

- s-Lock 이라고 하며, 데이터를 읽을 때 사용하는 Lock이다.
- 다른 **s-Lock**과 한 리소스에 두개 이상의 Lock을 동시에 설정할 수 있지만, **x-Lock**은 불가하다.
- 즉 여러 트랜잭션에서 동시에 하나의 데이터를 읽을 수 있다. 그러나 변경중인 리소스를 동시에 읽을 수는 없다.

**Exclusive Lock(베타, 쓰기 잠금, x-lock)**

- x-Lock 이라고 하며, 데이터를 변경할 때 사용한다.
- 다른 Lock들과 호환되지 않기 때문에, 한 리소스에 하나의 **x-Lock**만 설정 가능하다.
- 즉, **x-Lock**은 동시에 여러 트랜잭션이 한 리소스에 엑세스할 수 없게 된다. 읽기도 안된다.  
    오직 하나의 트랜잭션만 해당 리소스를 점유할 수 있다.

-> 낙관적 락이어도, SQL문은 update문 실행시 S-Lock이 걸린다
=> 동시성 처리 시, S-Lock, X-Lock이 서로 물려 [[데드락]]이 발생할 수 있음
비관적 락 외에 Redis, Kafka를 사용해도 데드락없이 해결 가능

### 출처
https://velog.io/@hyojhand/상품-주문-동시성-문제-해결하기-DeadLock-낙관적-락-비관적-락#비관적-락-테스트-코드--결과